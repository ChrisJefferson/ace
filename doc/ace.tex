%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%W  ace.tex                ACE documentation             Alexander Hulpke
%%
%H  $Id$
%%
%Y  Copyright (C) 1998, School of Math & Comp. Sci., St Andrews, Scotland
%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Chapter{The ACE share package}

The `ACE' share package permits the user to call the Advanced Coset 
Enumerator written by George Havas and Colin Ramsay from within {\GAP}. 
\index{ace}

\begintt
ACE coset enumerator (C) 1995-1999 by George Havas and Colin Ramsay
    http://www.csee.uq.edu.au/~havas/ace3.tar.gz
\endtt

The {\GAP} interface has been written by Alexander Hulpke.

The package interfaces to an external binary and therefore is only usable
under UNIX. It will not work on Windows or the Macintosh. It requires
{\GAP}~4.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{Installing the ACE share package}

To install, unpack the archive file in a directory in the `pkg' hierarchy of
your version of {\GAP}~4. (This might be the `pkg' directory of the
{\GAP}~4 home directory; it is however also possible to keep an additional
`pkg' directory in your private directories, see section "ref:Installing
Share Packages" of the {\GAP}~4 reference manual for details on how to do
this.) Go to the newly created `ACE' directory and call `./configure <path>'
where <path> is the path to the {\GAP} home directory. So for example if you
install the package in the main `pkg' directory call
\begintt
./configure ../..
\endtt
This will fetch the architecture type for which {\GAP} has been compiled last
and create a `Makefile'. 
Now simply call
\begintt
make
\endtt
to compile the binary and to install it in the appropriate place.

Note that the current version of the configuration process only sets up
directory paths. If you need a different compiler or different compiler
options, you need to edit `src/Makefile.in' prior to calling `make'
yourself.

If you use this installation of {\GAP} on different hardware platforms you will
have to compile the binary for each platform separately. This is done by
calling `configure' and `make' for the package anew immediately after
compiling {\GAP} itself for the respective architecture.
If your version of {\GAP} is already compiled (and has last been compiled on
the same architecture) you do not need to compile {\GAP}
again, it is sufficient to call the `configure' script in the {\GAP} home
directory.

For details on how to use the `ACE' package see the documentation in the
`doc' subdirectory.

The `src' subdirectory contains a copy of the original source of `ACE'. (The
only modification is that a file `Makefile.in' was obtained from the different
`make.xyz' and will be used to create a `Makefile'.)
You can replace the source by a newer version before compiling.

The subdirectory `acedoc' contains the file `acedoc.ps' which holds a
version of the `ACE' user manual (which forms part of \cite{aceman}). This
manual describes the various possibilities to guide the enumeration process.
If you are goind to call the `ACE' interface with options, it is recommended
you consult this manual for a detailled description.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{Loading the ACE share package}

To use the `ACE' package you have to request it explicitly. This is done by
calling 
\begintt
gap> RequirePackage("ace");
\endtt

If {\GAP} cannot find a working binary, the call to `RequirePackage' will
fail.

If you want to load the `ACE' package by default, you can put this
`RequirePackage' command in your `gaprc' file.

If you want to use the `ACE' coset enumerator as a default for all coset
enumerations done by {\GAP} (which may also get called indirectly), you can 
achieve this by setting the global variable `TCENUM' to `ACETCENUM'.
\begintt
gap> TCENUM:=ACETCENUM;;
\endtt

You
can switch back to the coset enumerator built into the {\GAP} library by
assigning `TCENUM' to `GAPTCENUM'.
\begintt
gap> TCENUM:=GAPTCENUM;;
\endtt


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{The ACE interface}

If you do not want to set up `ACE' globally for your coset enumerations,
you may call the `ACE' interface directly by:

\>CallACE(<fgens>,<rels>,<sgens>)

where <fgens> is a list of free generators, <rels> a list of words in these
generators giving relators for a finitely presented group and <sgens>
subgroup generators, again expressed as words in the free generators. The
operation calls the `ACE' coset enumerator and returns the (standardized)
coset table obtained. If the coset enumeration did not finish in the preset
limits it raises an error, respectively returns `fail' if the `silent'
option is given.
(See section "Options for the ACE enumerator" on how to extend these
limits and how to set enumeration options.)

\begintt
gap> g:=PerfectGroup(2^5*60,2);;
gap> f:=FreeGeneratorsOfFpGroup(g);;
gap> CallACE(f,RelatorsOfFpGroup(g),f{[1,2]});;
\endtt

(The variable `ACETCENUM.CosetTableFromGensAndRels' is assigned to
`CallACE'.)

If you only want to test, whether a coset enumeration terminates, you don't
want to transfer the whole coset table to {\GAP}. Instead, you can call

\>ACEStats(<fgens>,<rels>,<sgens>)

which calls the `ACE' binary and returns a list `[<index>,<c>,<m>,<t>]'
where <index> is the index of the subgroup (0 if the enumeration does not
succeed, and <c>, <m>, <t> are parameters for George Havas.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{Options for the ACE enumerator}

The `ACE' program offers a wide range of options to direct and guide a
coset enumeration.

Options are also used to specify technical parameters (such as the amount of
memory to be used) or the output format.

By default the `ACE' coset enumerator chooses strategies that work in many 
cases, however if problems become more complicated you might have to select
specific strategies to get the coset enumeration to finish successfully and
quickly.

All these options and their functionality are described in detail in the
`ACE' user manual you can find in the `acedoc' subdirectory.

This section therefore only lists how to pass the options syntactically from
{\GAP}. For a description of these options and of general enumeration
strategies we refer the reader to this manual.

Options are passed via the option mechanism of {\GAP} (see
chapter~"ref:Options Stack" in the reference manual):
Options can be are appended to the argument list of any function call,
separated by a colon from the argument list. They are then passed on
recursively to any subsequent inner function call (but these inner calls
could set options by themself which then might override options set before
for the scope of this inner function call.

Options are given like record components, separated by commas. As a
convenience for boolean options the assignement can be left out, defaulting
to a value of `true'. Note that the order in which the options are passed to
`ACE' is implicit in the interface, the order in which the options are given
in {\GAP} is ignored!

So for example to use the `hard' option and increase the workspace to $10^7$
words, one would call:
\begintt
gap> CallACE(f,RelatorsOfFpGroup(g),[]:hard,workspace:=10^7);;
\endtt

In the following list of recognized options for
the `ACE'/{\GAP} interface, boolean options are indicated just by a name
(such as `easy'), they default to `false' if not given. Options that take a
parameter are given as an assignement to the name (such as `time:=<val>').
If the name and the function is exactly the same as for an `ACE' option, no
further description is given here, see the `ACE' manual for details.

*Options that Modify the Enumeration Process:*

Except for the `number' option, all option names are the same as in the
`ACE' standalone.

\beginitems
`asis'&
Do not reduce relators.

`ct:=<val>'&
Number of C-style definitions per pass.

`rt:=<val>'&
Number of R-style definitions per pass.

`dmode:=<val>'&
Deduction mode.

`dsize:=<val>'&
Deduction stack size.

`pmode:=<val>'&
Parameter for preferred definitions.

`psize:=<val>'&
Size of preferred definition queue.

`fill:=<val>'&
Fill factor.

`look:=<val>'&
Lookahead

`number:=<val>'&
The `no' (number of relators in subgroup) parameter.

`mendelsohn'&
Turns on mendelsohn processing.

`norow'&
Set the `row filling' parameter to 0.

\enditems

*Strategies:*

The following boolen options can set the strategies as defined in the  `ACE'
manual: `default', `easy', `felsch0', `felsch1', `hard', `hlt', `purec',
`purer', `sims1', `sims3', `sims5', `sims7', and `sims9'.

Strategy options are parsed by the interface *before* any other option, it
is therefore possible to modify parameters on top of a strategy.

*Technical Options:*

\beginitems
`com:=<val>'&
Percentage of dead cosets to trigger compaction.

`max:=<val>'&
Maximum number of cosets to be defined.

`path'&
Turns on path compression.

`time:=<val>'&
Maximum execution time in seconds.

`workspace:=<val>'&
Workspace size in words (default $10^6$).
\enditems

*Information about the Enumeration:*

\beginitems
`aep:=<val>'&
Runs the enumeration for all equivalent presentations. Use with the `mess'
option to see the result.

`mess',`mess:=<val>'&
If only `mess' is given, messages are turned on. It is also possible to
assigne the message level.

`messfile:=<filename>'&
Messages are printed in file <filename> (the default output is on the
screen).

`rep:=<val>'&
Runs the enumeration for random equivalent presentations. See the `aep'
option.
\enditems

The `ACE' standalone provides further features, in particular the possibility
for interactive work. These features are not available via {\GAP}, however
the option `outfile:=<filename>' will  keep the input file for `ACE'
produced by the {\GAP} interface under the file name <filename> (and just
return `fail') so that one could perform this interactive work in the
standalone by hand.

For compatibility with the coset enumerator built into {\GAP}
(see~"ref:CosetTableFromGensAndRels" in the reference manual), also the
`silent' option is recognized. (Note that the `max' option has the same
name and functionality in `ACE' as well.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{Examples of ACE Calls with Options}

The following example calls `ACE' for up to 800 cosets using
Mendelsohn style relator processing and sets the message level to 500
\begintt
gap> g:=PerfectGroup(2^5*60,2);;
gap> f:=FreeGeneratorsOfFpGroup(g);;
gap> CallACE(f,RelatorsOfFpGroup(g),f{[1]}:mendelsohn,max:=800,mess:=500);;
ACE 3.000        Fri Aug 20 16:05:01 1999
=========================================
Host information:
  name = muir
  #-- ACE 3.000: Run Parameters ---
Group Name: G;
Group Generators: abcdefg;
Group Relators: (c)^2, (d)^2, (e)^2, (f)^2, (g)^2, aag, (b)^3, (cd)^2, 
  (ef)^2, (ce)^2, (cf)^2, (de)^2, (df)^2, Acae, Adaf, Aeac, Afad, Bfbe, 
  gAga, gBgb, (gc)^2, (gd)^2, (ge)^2, (gf)^2, Bebfe, Bcbgfd, Bdbfedc, 
  (ab)^5;
Subgroup Name: H;
Subgroup Generators: a;
Wo:1000000; Max:500; Mess:500; Ti:-1; Ho:-1; Loop:0;
As:0; Path:0; Row:1; Mend:1; No:28; Look:0; Com:10;
C:0; R:0; Fi:13; PMod:3; PSiz:256; DMod:4; DSiz:1000;
  #--------------------------------
SG: a=1 r=1 h=1 n=2; l=1 c=+0.00; m=1 t=1
RD: a=321 r=68 h=1 n=412; l=5 c=+0.00; m=327 t=411
CL: a=302 r=107 h=1 n=501; l=7 c=+0.01; m=327 t=500
DD: a=302 r=107 h=1 n=501; l=8 c=+0.00; d=386
CO: a=302 r=83 h=139 n=303; l=9 c=+0.01; m=327 t=500
DD: a=379 r=101 h=237 n=388; l=11 c=+0.00; d=3
DD: a=456 r=101 h=266 n=465; l=11 c=+0.00; d=5
INDEX = 480 (a=480 r=101 h=489 n=489; l=12 c=0.02; m=480 t=686)
\endtt

If `ACE' is made the standard coset enumerator the same method of passing
arguments may be used with all other commands and will affect coset
enumerations. As an example we use the `ACE' enumerator to compute the
permutation representation of a perfect group from the data library:

\begintt
gap> TCENUM:=ACETCENUM;;
gap> PerfectGroup(IsPermGroup,16*60,1:max:=50,mess);
gap> PerfectGroup(IsPermGroup,16*60,1:max:=50,mess);
ACE 3.000        Fri Aug 20 16:06:16 1999
=========================================
Host information:
  name = muir
INDEX = 16 (a=16 r=36 h=1 n=36; l=3 c=0.00; m=30 t=35)
A5 2^4
\endtt

(If you run the examples time, machine name or the version number of the
binary might differ.)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{Further Facilities of the Standalone}

The `ACE' standalone provides a couple of further possibilities to work
interactively with a coset table or to work with incomplete coset table.
These facilities are not available through {\GAP}, mainly because as the
time of writing {\GAP} does not yet provide all necessary features.
It would be possible to add these features at a later stage.
